#!/bin/sh
exec 2>&1
exec uwsgi \
<% lineterm = "\\" -%>
<% node['graphite']['uwsgi']['config'].each_with_index do |(param, val), index| -%>
<% if index == node['graphite']['uwsgi']['config'].size - 1 -%>
<% lineterm = "" -%>
<% end -%>
<% if val.is_a? String -%>
--<%= param %> <%= val %> <%= lineterm %>
<% elsif val.is_a? Integer -%>
--<%= param %> <%= val.to_s %> <%= lineterm %>
<% elsif !!val == val -%>
--<%= param %> <%= lineterm %>
<% elsif val.is_a? Array -%>
<% val.each do |eachval| -%>
--<%= param %> <%= eachval %> <%= lineterm %>
<% end -%>
<% end -%>
<% end -%>
